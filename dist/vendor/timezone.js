/*! banana-fusion - v1.6.29 - 2020-12-16
 * https://github.com/LucidWorks/banana/wiki
 * Copyright (c) 2020 Andrew Thanalertvisuti; Licensed Apache-2.0 */

(function(){"use strict";var a,b=this;a="undefined"!=typeof exports?exports:b.timezoneJS={},a.VERSION="0.4.4";for(var c,d=b.$||b.jQuery||b.Zepto,e=b.fleegix,f=a.Days=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],g=a.Months=["January","February","March","April","May","June","July","August","September","October","November","December"],h={},i={},j={},k=new RegExp("^[a-zA-Z]+/"),l=0;l<g.length;l++)h[g[l].substr(0,3)]=l;for(l=0;l<f.length;l++)i[f[l].substr(0,3)]=l;c=Array.prototype.indexOf||function(a){if(null===this)throw new TypeError;var b=Object(this),c=b.length>>>0;if(0===c)return-1;var d=0;if(arguments.length>1&&(d=Number(arguments[1]),d!=d?d=0:0!==d&&d!==1/0&&d!==-(1/0)&&(d=(d>0||-1)*Math.floor(Math.abs(d)))),d>=c)return-1;for(var e=d>=0?d:Math.max(c-Math.abs(d),0);e<c;e++)if(e in b&&b[e]===a)return e;return-1};var m=function(a,b){if("number"!=typeof a)throw"not a number: "+a;var c=a.toString();if(a.length>b)return a.substr(a.length-b,a.length);for(;c.length<b;)c="0"+c;return c},n=function(a){if(!(e&&"undefined"!=typeof e.xhr||d&&"undefined"!=typeof d.ajax))throw new Error("Please use the Fleegix.js XHR module, jQuery ajax, Zepto ajax, or define your own transport mechanism for downloading zone files.");if(a){if(!a.url)throw new Error("URL must be specified");return"async"in a||(a.async=!0),a.async?e&&e.xhr?e.xhr.send({url:a.url,method:"get",handleSuccess:a.success,handleErr:a.error}):d.ajax({url:a.url,dataType:"text",method:"GET",error:a.error,success:a.success}):e&&e.xhr?e.xhr.doReq({url:a.url,async:!1}):d.ajax({url:a.url,async:!1}).responseText}};a.Date=function(){var a=Array.prototype.slice.apply(arguments),b=null,c=null,d=[];switch("[object Array]"===Object.prototype.toString.call(a[0])&&(a=a[0]),"string"==typeof a[a.length-1]&&k.test(a[a.length-1])&&(c=a.pop()),a.length){case 0:b=new Date;break;case 1:b=new Date(a[0]);break;default:for(var e=0;e<7;e++)d[e]=a[e]||0;b=new Date(d[0],d[1],d[2],d[3],d[4],d[5],d[6])}this._useCache=!1,this._tzInfo={},this._day=0,this.year=0,this.month=0,this.date=0,this.hours=0,this.minutes=0,this.seconds=0,this.milliseconds=0,this.timezone=c||null,d.length?this.setFromDateObjProxy(b):this.setFromTimeProxy(b.getTime(),c)},a.Date.prototype={getDate:function(){return this.date},getDay:function(){return this._day},getFullYear:function(){return this.year},getMonth:function(){return this.month},getYear:function(){return this.year-1900},getHours:function(){return this.hours},getMilliseconds:function(){return this.milliseconds},getMinutes:function(){return this.minutes},getSeconds:function(){return this.seconds},getUTCDate:function(){return this.getUTCDateProxy().getUTCDate()},getUTCDay:function(){return this.getUTCDateProxy().getUTCDay()},getUTCFullYear:function(){return this.getUTCDateProxy().getUTCFullYear()},getUTCHours:function(){return this.getUTCDateProxy().getUTCHours()},getUTCMilliseconds:function(){return this.getUTCDateProxy().getUTCMilliseconds()},getUTCMinutes:function(){return this.getUTCDateProxy().getUTCMinutes()},getUTCMonth:function(){return this.getUTCDateProxy().getUTCMonth()},getUTCSeconds:function(){return this.getUTCDateProxy().getUTCSeconds()},getTime:function(){return this._timeProxy+60*this.getTimezoneOffset()*1e3},getTimezone:function(){return this.timezone},getTimezoneOffset:function(){return this.getTimezoneInfo().tzOffset},getTimezoneAbbreviation:function(){return this.getTimezoneInfo().tzAbbr},getTimezoneInfo:function(){if(this._useCache)return this._tzInfo;var b;return b=this.timezone?"Etc/UTC"===this.timezone||"Etc/GMT"===this.timezone?{tzOffset:0,tzAbbr:"UTC"}:a.timezone.getTzInfo(this._timeProxy,this.timezone):{tzOffset:this.getLocalOffset(),tzAbbr:null},this._tzInfo=b,this._useCache=!0,b},getUTCDateProxy:function(){var a=new Date(this._timeProxy);return a.setUTCMinutes(a.getUTCMinutes()+this.getTimezoneOffset()),a},setDate:function(a){return this.setAttribute("date",a),this.getTime()},setFullYear:function(a,b,c){return void 0!==c&&this.setAttribute("date",1),this.setAttribute("year",a),void 0!==b&&this.setAttribute("month",b),void 0!==c&&this.setAttribute("date",c),this.getTime()},setMonth:function(a,b){return this.setAttribute("month",a),void 0!==b&&this.setAttribute("date",b),this.getTime()},setYear:function(a){return a=Number(a),0<=a&&a<=99&&(a+=1900),this.setUTCAttribute("year",a),this.getTime()},setHours:function(a,b,c,d){return this.setAttribute("hours",a),void 0!==b&&this.setAttribute("minutes",b),void 0!==c&&this.setAttribute("seconds",c),void 0!==d&&this.setAttribute("milliseconds",d),this.getTime()},setMinutes:function(a,b,c){return this.setAttribute("minutes",a),void 0!==b&&this.setAttribute("seconds",b),void 0!==c&&this.setAttribute("milliseconds",c),this.getTime()},setSeconds:function(a,b){return this.setAttribute("seconds",a),void 0!==b&&this.setAttribute("milliseconds",b),this.getTime()},setMilliseconds:function(a){return this.setAttribute("milliseconds",a),this.getTime()},setTime:function(a){if(isNaN(a))throw new Error("Units must be a number.");return this.setFromTimeProxy(a,this.timezone),this.getTime()},setUTCFullYear:function(a,b,c){return void 0!==c&&this.setUTCAttribute("date",1),this.setUTCAttribute("year",a),void 0!==b&&this.setUTCAttribute("month",b),void 0!==c&&this.setUTCAttribute("date",c),this.getTime()},setUTCMonth:function(a,b){return this.setUTCAttribute("month",a),void 0!==b&&this.setUTCAttribute("date",b),this.getTime()},setUTCDate:function(a){return this.setUTCAttribute("date",a),this.getTime()},setUTCHours:function(a,b,c,d){return this.setUTCAttribute("hours",a),void 0!==b&&this.setUTCAttribute("minutes",b),void 0!==c&&this.setUTCAttribute("seconds",c),void 0!==d&&this.setUTCAttribute("milliseconds",d),this.getTime()},setUTCMinutes:function(a,b,c){return this.setUTCAttribute("minutes",a),void 0!==b&&this.setUTCAttribute("seconds",b),void 0!==c&&this.setUTCAttribute("milliseconds",c),this.getTime()},setUTCSeconds:function(a,b){return this.setUTCAttribute("seconds",a),void 0!==b&&this.setUTCAttribute("milliseconds",b),this.getTime()},setUTCMilliseconds:function(a){return this.setUTCAttribute("milliseconds",a),this.getTime()},setFromDateObjProxy:function(a){this.year=a.getFullYear(),this.month=a.getMonth(),this.date=a.getDate(),this.hours=a.getHours(),this.minutes=a.getMinutes(),this.seconds=a.getSeconds(),this.milliseconds=a.getMilliseconds(),this._day=a.getDay(),this._dateProxy=a,this._timeProxy=Date.UTC(this.year,this.month,this.date,this.hours,this.minutes,this.seconds,this.milliseconds),this._useCache=!1},setFromTimeProxy:function(b,c){var d,e=new Date(b);d=c?a.timezone.getTzInfo(e,c).tzOffset:e.getTimezoneOffset(),e.setTime(b+6e4*(e.getTimezoneOffset()-d)),this.setFromDateObjProxy(e)},setAttribute:function(a,b){if(isNaN(b))throw new Error("Units must be a number.");var c=this._dateProxy,d="year"===a?"FullYear":a.substr(0,1).toUpperCase()+a.substr(1);c["set"+d](b),this.setFromDateObjProxy(c)},setUTCAttribute:function(a,b){if(isNaN(b))throw new Error("Units must be a number.");var c="year"===a?"FullYear":a.substr(0,1).toUpperCase()+a.substr(1),d=this.getUTCDateProxy();d["setUTC"+c](b),d.setUTCMinutes(d.getUTCMinutes()-this.getTimezoneOffset()),this.setFromTimeProxy(d.getTime()+6e4*this.getTimezoneOffset(),this.timezone)},setTimezone:function(a){var b=this.getTimezoneInfo().tzOffset;this.timezone=a,this._useCache=!1,this.setUTCMinutes(this.getUTCMinutes()-this.getTimezoneInfo().tzOffset+b)},removeTimezone:function(){this.timezone=null,this._useCache=!1},valueOf:function(){return this.getTime()},clone:function(){return this.timezone?new a.Date(this.getTime(),this.timezone):new a.Date(this.getTime())},toGMTString:function(){return this.toString("EEE, dd MMM yyyy HH:mm:ss Z","Etc/GMT")},toLocaleString:function(){},toLocaleDateString:function(){},toLocaleTimeString:function(){},toSource:function(){},toISOString:function(){return this.toString("yyyy-MM-ddTHH:mm:ss.SSS","Etc/UTC")+"Z"},toJSON:function(){return this.toISOString()},toString:function(b,c){b||(b="yyyy-MM-dd HH:mm:ss");var d=b,e=c?a.timezone.getTzInfo(this.getTime(),c):this.getTimezoneInfo(),g=this;c&&(g=this.clone(),g.setTimezone(c));var h=g.getHours();return d.replace(/a+/g,function(){return"k"}).replace(/y+/g,function(a){return m(g.getFullYear(),a.length)}).replace(/d+/g,function(a){return m(g.getDate(),a.length)}).replace(/m+/g,function(a){return m(g.getMinutes(),a.length)}).replace(/s+/g,function(a){return m(g.getSeconds(),a.length)}).replace(/S+/g,function(a){return m(g.getMilliseconds(),a.length)}).replace(/M+/g,function(b){var c=g.getMonth(),d=b.length;return d>3?a.Months[c]:d>2?a.Months[c].substring(0,d):m(c+1,d)}).replace(/k+/g,function(){return h>=12?(h>12&&(h-=12),"PM"):"AM"}).replace(/H+/g,function(a){return m(h,a.length)}).replace(/E+/g,function(a){return f[g.getDay()].substring(0,a.length)}).replace(/Z+/gi,function(){return e.tzAbbr})},toUTCString:function(){return this.toGMTString()},civilToJulianDayNumber:function(a,b,c){var d;b++,b>12&&(d=parseInt(b/12,10),b%=12,a+=d),b<=2&&(a-=1,b+=12),d=Math.floor(a/100);var e=2-d+Math.floor(d/4),f=Math.floor(365.25*(a+4716))+Math.floor(30.6001*(b+1))+c+e-1524;return f},getLocalOffset:function(){return this._dateProxy.getTimezoneOffset()}},a.timezone=new function(){function a(a){throw new Error('Timezone "'+a+'" is either incorrect, or not loaded in the timezone registry.')}function b(a,b){var c=p.zoneFileBasePath+"/"+a;return b&&b.async?p.transport({async:!0,url:c,success:function(a){return p.parseZones(a)&&"function"==typeof b.callback&&b.callback(),!0},error:function(){throw new Error('Error retrieving "'+c+'" zoneinfo files')}}):p.parseZones(p.transport({url:c,async:!1}))}function d(b){var c,e,f=r[b];if(f)return f;if(c=b.split("/")[0],e=q[c])return e;var g=p.zones[b];return"string"==typeof g?d(g):p.loadedZones.backward?void a(b):(p.loadZoneFile("backward"),d(b))}function e(a){var b=/(\d+)(?::0*(\d*))?(?::0*(\d*))?([wsugz])?$/,c=a.match(b);return c[1]=parseInt(c[1],10),c[2]=c[2]?parseInt(c[2],10):0,c[3]=c[3]?parseInt(c[3],10):0,c}function f(a){if(a[3]){var b=parseInt(a[3],10),c=11,d=31;a[4]&&(c=h[a[4].substr(0,3)],d=parseInt(a[5],10)||1);var f=a[6]?a[6]:"00:00:00",g=e(f);return[b,c,d,g[1],g[2],g[3]]}}function g(b,c){for(var d="number"==typeof b?b:new Date(b).getTime(),e=c,f=p.zones[e];"string"==typeof f;)e=f,f=p.zones[e];if(!f){if(!p.loadedZones.backward)return p.loadZoneFile("backward"),g(b,c);a(e)}if(0===f.length)throw new Error('No Zone found for "'+c+'" on '+b);for(var h=f.length-1;h>=0;h--){var i=f[h];if(i[3]&&d>i[3])break}return f[h+1]}function k(a){var b=e(a),c="-"===a.charAt(0)?-1:1;return b=c*(1e3*(60*(60*b[1]+b[2])+b[3])),b/60/1e3}function l(a,b,d){var f="number"==typeof a?new Date(a):a,g=b[1],k=b[0],l=g.match(/^([0-9]):([0-9][0-9])$/);if(l)return[-1e6,"max","-","Jan",1,e("0:00"),60*parseInt(l[1])+parseInt(l[2]),"-"];var n,o=function(a,b,c){var d=0;if("u"===b||"g"===b||"z"===b)d=0;else if("s"===b)d=k;else{if("w"!==b&&b)throw"unknown type "+b;d=m(k,c)}return d*=6e4,new Date(a.getTime()+d)},q=function(a,b){var c,d=a[0],e=a[1],f=e[5];if(j[d]||(j[d]={}),j[d][e])c=j[d][e];else{if(isNaN(e[4])){var g,k;"last"===e[4].substr(0,4)?(c=new Date(Date.UTC(d,h[e[3]]+1,1,f[1]-24,f[2],f[3],0)),g=i[e[4].substr(4,3)],k="<="):(c=new Date(Date.UTC(d,h[e[3]],e[4].substr(5),f[1],f[2],f[3],0)),g=i[e[4].substr(0,3)],k=e[4].substr(3,2));var l=c.getUTCDay();">="===k?c.setUTCDate(c.getUTCDate()+(g-l+(g<l?7:0))):c.setUTCDate(c.getUTCDate()+(g-l-(g>l?7:0)))}else c=new Date(Date.UTC(d,h[e[3]],e[4],f[1],f[2],f[3],0));j[d][e]=c}return b&&(c=o(c,f[4],b)),c},r=function(a,b){for(var c=[],d=0;b&&d<b.length;d++)b[d][0]<=a&&(b[d][1]>=a||b[d][0]===a&&"only"===b[d][1]||"max"===b[d][1])&&c.push([a,b[d]]);return c},s=function(a,b,c){var e,f;return a.constructor!==Date?(e=a[0],f=a[1],a=!c&&j[e]&&j[e][f]?j[e][f]:q(a,c)):c&&(a=o(a,d?"u":"w",c)),b.constructor!==Date?(e=b[0],f=b[1],b=!c&&j[e]&&j[e][f]?j[e][f]:q(b,c)):c&&(b=o(b,d?"u":"w",c)),a=Number(a),b=Number(b),a-b},t=f.getUTCFullYear();n=r(t,p.rules[g]),n.push(f),n.sort(s),c.call(n,f)<2&&(n=n.concat(r(t-1,p.rules[g])),n.sort(s));var u=c.call(n,f);return u>1&&s(f,n[u-1],n[u-2][1])<0?n[u-2][1]:u>0&&u<n.length-1&&s(f,n[u+1],n[u-1][1])>0?n[u+1][1]:0===u?null:n[u-1][1]}function m(a,b){return-Math.ceil(b[6]-a)}function o(a,b){var c,d=a[2];if(d.indexOf("%s")>-1){var e;e=b?"-"===b[7]?"":b[7]:"S",c=d.replace("%s",e)}else c=d.indexOf("/")>-1?d.split("/",2)[b[6]?1:0]:d;return c}var p=this,q={Etc:"etcetera",EST:"northamerica",MST:"northamerica",HST:"northamerica",EST5EDT:"northamerica",CST6CDT:"northamerica",MST7MDT:"northamerica",PST8PDT:"northamerica",America:"northamerica",Pacific:"australasia",Atlantic:"europe",Africa:"africa",Indian:"africa",Antarctica:"antarctica",Asia:"asia",Australia:"australasia",Europe:"europe",WET:"europe",CET:"europe",MET:"europe",EET:"europe"},r={"Pacific/Honolulu":"northamerica","Atlantic/Bermuda":"northamerica","Atlantic/Cape_Verde":"africa","Atlantic/St_Helena":"africa","Indian/Kerguelen":"antarctica","Indian/Chagos":"asia","Indian/Maldives":"asia","Indian/Christmas":"australasia","Indian/Cocos":"australasia","America/Danmarkshavn":"europe","America/Scoresbysund":"europe","America/Godthab":"europe","America/Thule":"europe","Asia/Yekaterinburg":"europe","Asia/Omsk":"europe","Asia/Novosibirsk":"europe","Asia/Krasnoyarsk":"europe","Asia/Irkutsk":"europe","Asia/Yakutsk":"europe","Asia/Vladivostok":"europe","Asia/Sakhalin":"europe","Asia/Magadan":"europe","Asia/Kamchatka":"europe","Asia/Anadyr":"europe","Africa/Ceuta":"europe","America/Argentina/Buenos_Aires":"southamerica","America/Argentina/Cordoba":"southamerica","America/Argentina/Tucuman":"southamerica","America/Argentina/La_Rioja":"southamerica","America/Argentina/San_Juan":"southamerica","America/Argentina/Jujuy":"southamerica","America/Argentina/Catamarca":"southamerica","America/Argentina/Mendoza":"southamerica","America/Argentina/Rio_Gallegos":"southamerica","America/Argentina/Ushuaia":"southamerica","America/Aruba":"southamerica","America/La_Paz":"southamerica","America/Noronha":"southamerica","America/Belem":"southamerica","America/Fortaleza":"southamerica","America/Recife":"southamerica","America/Araguaina":"southamerica","America/Maceio":"southamerica","America/Bahia":"southamerica","America/Sao_Paulo":"southamerica","America/Campo_Grande":"southamerica","America/Cuiaba":"southamerica","America/Porto_Velho":"southamerica","America/Boa_Vista":"southamerica","America/Manaus":"southamerica","America/Eirunepe":"southamerica","America/Rio_Branco":"southamerica","America/Santiago":"southamerica","Pacific/Easter":"southamerica","America/Bogota":"southamerica","America/Curacao":"southamerica","America/Guayaquil":"southamerica","Pacific/Galapagos":"southamerica","Atlantic/Stanley":"southamerica","America/Cayenne":"southamerica","America/Guyana":"southamerica","America/Asuncion":"southamerica","America/Lima":"southamerica","Atlantic/South_Georgia":"southamerica","America/Paramaribo":"southamerica","America/Port_of_Spain":"southamerica","America/Montevideo":"southamerica","America/Caracas":"southamerica"};this.zoneFileBasePath=null,this.zoneFiles=["africa","antarctica","asia","australasia","backward","etcetera","europe","northamerica","pacificnew","southamerica"],this.loadingSchemes={PRELOAD_ALL:"preloadAll",LAZY_LOAD:"lazyLoad",MANUAL_LOAD:"manualLoad"},this.loadingScheme=this.loadingSchemes.LAZY_LOAD,this.loadedZones={},this.zones={},this.rules={},this.init=function(a){var b,c={async:!0},d=this.loadingScheme===this.loadingSchemes.PRELOAD_ALL?this.zoneFiles:this.defaultZoneFile||"northamerica",e=0;for(var f in a)c[f]=a[f];if("string"==typeof d)return this.loadZoneFile(d,c);b=c.callback,c.callback=function(){e++,e===d.length&&"function"==typeof b&&b()};for(var g=0;g<d.length;g++)this.loadZoneFile(d[g],c)},this.loadZoneFile=function(a,c){if("undefined"==typeof this.zoneFileBasePath)throw new Error("Please define a base path to your zone file directory -- timezoneJS.timezone.zoneFileBasePath.");if(!this.loadedZones[a])return this.loadedZones[a]=!0,b(a,c)},this.loadZoneJSONData=function(a,b){var c=function(a){a=JSON.parse(a);for(var b in a.zones)p.zones[b]=a.zones[b];for(var c in a.rules)p.rules[c]=a.rules[c]};return b?c(p.transport({url:a,async:!1})):p.transport({url:a,success:c})},this.loadZoneDataFromObject=function(a){if(a){for(var b in a.zones)p.zones[b]=a.zones[b];for(var c in a.rules)p.rules[c]=a.rules[c]}},this.getAllZones=function(){var a=[];for(var b in this.zones)a.push(b);return a.sort()},this.parseZones=function(a){for(var b,c=a.split("\n"),d=[],g="",h=null,i=null,j=0;j<c.length;j++)if(b=c[j],b.match(/^\s/)&&(b="Zone "+h+b),b=b.split("#")[0],b.length>3)switch(d=b.split(/\s+/),g=d.shift()){case"Zone":if(h=d.shift(),p.zones[h]||(p.zones[h]=[]),d.length<3)break;d.splice(3,d.length,f(d)),d[3]&&(d[3]=Date.UTC.apply(null,d[3])),d[0]=-k(d[0]),p.zones[h].push(d);break;case"Rule":i=d.shift(),p.rules[i]||(p.rules[i]=[]),d[0]=parseInt(d[0],10),d[1]=parseInt(d[1],10)||d[1],d[5]=e(d[5]),d[6]=k(d[6]),p.rules[i].push(d);break;case"Link":if(p.zones[d[1]])throw new Error("Error with Link "+d[1]+". Cannot create link of a preexisted zone.");p.zones[d[1]]=d[0]}return!0},this.transport=n,this.getTzInfo=function(a,b,c){if(this.loadingScheme===this.loadingSchemes.LAZY_LOAD){var e=d(b);if(!e)throw new Error("Not a valid timezone ID.");this.loadedZones[e]||this.loadZoneFile(e)}var f=g(a,b),h=f[0],i=l(a,f,c);i&&(h=m(h,i));var j=o(f,i);return{tzOffset:h,tzAbbr:j}}}}).call(this);