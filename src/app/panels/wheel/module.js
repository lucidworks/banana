/*
  ## D3 Bar Chart with Tooltip Integrated with Banana.
  ## Demo URL: bl.ocks.org/Caged/6476579

  ### Parameters
  * field :: Field for Facet Query for Bar Chart Data.
  * size :: Maximum Number of Bars.
*/
define([
    'angular',
    'app',
    'underscore',
    'jquery',
    'kbn',
    'd3',
    './d3.tip'
  ],
  function(angular, app, _, $, kbn, d3, d3tip) {
    'use strict';

    var module = angular.module('kibana.panels.bar', []);
    app.useModule(module);

    module.controller('wheel', function($scope, querySrv, dashboard, filterSrv) {
      $scope.panelMeta = {
        modals: [{
          description: "Inspect",
          icon: "icon-info-sign",
          partial: "app/partials/inspector.html",
          show: $scope.panel.spyable
        }],
        editorTabs: [{
          title: 'Queries',
          src: 'app/partials/querySelect.html'
        }],
        status: "Experimental",
        description: "Display the D3 Bar Chart with Tooltip."
      };

      // Set and populate defaults
      var _d = {
        queries: {
          mode: 'all',
          query: '*:*',
          custom: ''
        },
        field: '',
        size: 10,
        spyable: true,
        show_queries: true,
        error: '',
      };
      _.defaults($scope.panel, _d);

      $scope.init = function() {
        $scope.hits = 0;
        $scope.$on('refresh', function() {
          $scope.get_data();
        });
        $scope.get_data();
      };

      $scope.get_data = function() {
      	// Make sure we have everything for the request to complete
        if (dashboard.indices.length === 0) {
          return;
        }
        delete $scope.panel.error;
        $scope.panelMeta.loading = true;
        var request, results;

        $scope.sjs.client.server(dashboard.current.solr.server + dashboard.current.solr.core_name);

        request = $scope.sjs.Request().indices(dashboard.indices);
        $scope.panel.queries.ids = querySrv.idsByMode($scope.panel.queries);

        // Populate the inspector panel
        $scope.inspector = angular.toJson(JSON.parse(request.toString()), true);

        // Build Solr query
        var fq = '';
        if (filterSrv.getSolrFq() && filterSrv.getSolrFq() !== '') {
          fq = '&' + filterSrv.getSolrFq();
        }
        var wt_json = '&wt=json';
        var rows_limit = '&rows=0'; // for terms, we do not need the actual response doc, so set rows=0
        var facet = '&facet=true&facet.field=' + $scope.panel.field + '&facet.limit=' + $scope.panel.size;

        // Set the panel's query
        $scope.panel.queries.query = querySrv.getORquery() + wt_json + rows_limit + fq + facet;

        // Set the additional custom query
        if ($scope.panel.queries.custom != null) {
          request = request.setQuery($scope.panel.queries.query + $scope.panel.queries.custom);
        } else {
          request = request.setQuery($scope.panel.queries.query);
        }

        results = request.doSearch();

        // Populate scope when we have results
        results.then(function(results) {
          // Check for error and abort if found
          if (!(_.isUndefined(results.error))) {
            $scope.panel.error = $scope.parse_error(results.error.msg);
            return;
          }

          var sum = 0;
          var missing = 0;
          $scope.panelMeta.loading = false;
          $scope.hits = results.response.numFound;
          $scope.data = [];
          $scope.maxRatio = 0;

          $scope.yaxis_min = 0;
          _.each(results.facet_counts.facet_fields, function(v) {
            for (var i = 0; i < v.length; i++) {
              var term = v[i];
              i++;
              var count = v[i];
              sum += count;
              if (term === null) {
                missing = count;
              } else {
                // if count = 0, do not add it to the chart, just skip it
                if (count === 0) {
                  continue;
                }
                var slice = {
                  letter: term,
                  frequency: count                
              	};
                if (count / $scope.hits > $scope.maxRatio) {
                  $scope.maxRatio = count / $scope.hits;
                }
                $scope.data.push(slice);
              }
            }
          });
          $scope.$emit('render');
        });
      };

      $scope.build_search = function(word) {
        if(word) {
          filterSrv.set({type:'terms',field:$scope.panel.field,value:word,mandate:'must'});
        } else {
          return;
        }
        dashboard.refresh();
      };

      $scope.set_refresh = function(state) {
        $scope.refresh = state;
        // if 'count' mode is selected, set decimal_points to zero automatically.
        if ($scope.panel.mode === 'count') {
          $scope.panel.decimal_points = 0;
        }
      };

      $scope.close_edit = function() {
        if ($scope.refresh) {
          $scope.get_data();
        }
        $scope.refresh = false;
        $scope.$emit('render');
      };
    });
	/////////////////////////////////////////////////////////////////////////////

	
	
	
	
	
	alert("inside the chart");
	
	
	
	
	
	
	
	
	
	
	

    module.directive('wheelChart', function() {
      return {
        restrict: 'A',
        link: function(scope, element) {
          // Receive render events
          scope.$on('render', function() {
            render_panel();
          });

          // Re-render if the window is resized
          angular.element(window).bind('resize', function() {
            render_panel();
          });
          // Function for rendering panel
          function render_panel() {
			element.html("");
            var width = element.parent().width();
            var height = parseInt(scope.row.height);
			var label, label_angle, display_mode, large_arc, week_kwh ;
			var energy_data = [0.176042,0.096146,0.076414,0.334734,0.132583,0.135422,0.060884,0.768601,0.230771,0.07572,0.210855,0.090938,0.094296,0.290368,0.093755,0.099166,0.429278,0.962314,0.43833,0.244464,0.550621,0.173093,0.103659,0.0773,0.265913,0.099811,0.076164,0.3154,0.146557,0.108531,0.421608,0.120872,0.061825,0.101988,0.095364,0.365022,0.096741,0.095962,0.06409,0.300409,0.102083,0.134949,0.535842,0.224584,0.227262,0.28274,0.11842,0.062601,0.103968,0.088054,0.069683,0.141973,0.106082,0.135513,0.09906,0.099516,0.31927,0.097133,0.08595,0.067532,0.096042,0.09789,0.059053,0.11167,0.137408,0.109005,0.365752,0.179085,0.135975,0.199275,0.144186,0.053961,0.088226,0.09218,0.059777,0.125663,0.136192,0.121279,0.146825,0.267907,0.113706,0.09266,0.105833,0.130221,0.09695,0.078355,0.067088,0.093888,0.096131,0.152373,0.072957,0.095516,0.091731,0.14403,0.113989,0.089659,0.089808,0.085082,0.057542,0.09864,0.091152,0.066592,0.20529,0.12785,0.077798,0.071004,0.094316,0.088963,0.054368,0.091964,0.095114,0.071649,0.076153,0.150208,0.15751,0.065801,0.087791,0.100653,0.121987,0.161462,0.096507,0.093314,0.075191,0.07723,0.091846,0.095587,0.053434,1.017331,1.458327,0.120566,0.107582,0.139082,0.112224,0.159757,0.252278,0.161521,0.124628,0.080985,0.634034,0.248268,0.20864,0.14324,0.174345,0.165649,0.116201,0.119975,0.133551,0.138756,0.128587,0.171464,1.328931,0.318976,0.436703,0.109017,0.1716,0.324534,0.258161,0.20793,0.169164,0.191496,0.125737,0.320198,0.272419,0.222312,0.247595,0.192478,0.134997,0.152271,0.149265,0.153333,0.120128,0.144328,0.15462,0.147139,0.467675,0.785769,0.169233,0.152792,0.124015,0.150723,0.154728,0.133904,0.138484,0.145108,0.101576,0.300465,0.51319,0.279765,0.107491,0.138062,0.241017,0.12055,0.09796,0.103707,0.103066,0.145396,0.146956,0.147599,0.105225,0.099295,0.088016,0.091518,0.104558,0.102263,0.108526,0.105913,0.091529,0.085067,0.102965,0.158836,0.357985,0.149226,0.196574,0.191374,0.194802,0.161337,0.113211,0.108476,0.089321,0.138892,0.146119,0.151974,0.115019,0.470561,0.153572,0.093566,0.106534,0.109151,0.11014,0.093481,0.08872,0.110091,0.114333,0.109234,0.245834,0.150534,0.120163,0.155335,0.099323,0.114746,0.099623,0.084517,0.113151,0.147347,0.113611,0.157787,0.113805,0.213531,0.207369,0.110758,0.092851,0.086095,0.113015,0.104308,0.07683,0.114113,0.128897,0.401883,0.113495,0.114038,0.099651,0.08429,0.217111,0.188359,0.117093,0.154136,0.157069,0.113601,0.155379,0.153499,0.094375,0.255474,0.112298,0.069018,0.115629,0.098764,0.08282,0.119913,0.082257,0.105759,0.118708,0.138782,0.43461,0.270003,0.308089,0.190532,0.159851,0.119177,0.156233,0.152176,0.121591,0.161727,0.13583,0.139779,0.158679,0.310413,1.036022,0.761001,0.189852,0.117636,0.076667,0.114343,0.110304,0.074719,0.123574,0.147048,0.227763,0.111874,0.120018,0.167578,0.078485,0.183556,0.086496,0.105273,0.11033,0.128906,0.157715,0.110767,0.130433,0.07149,0.1255,0.45136,0.189705,0.28827,0.137405,0.164043,0.137172,0.317151,0.323415,0.621579,0.391155,0.179726,0.171926,0.150099,0.163347,0.077704,0.139602,0.083194,0.177218,0.123166,0.181243,0.113841,0.150831,0.375315,0.172501,0.082629,0.127441,0.098164,0.115714,0.120421,0.105526,0.127972,0.093565,0.133092,0.360579,0.328139,0.182104,0.300767,0.195139,0.186862,0.077707,0.134383,0.08696,0.165732,0.133646,0.168006,0.079819,0.107076,0.115384,0.118227,0.091025,0.094212,0.115114,0.119134,0.106764,0.0883,0.103758,0.122481,0.250705,0.160711,0.126313,0.225647,0.197973,0.12086,0.119024,0.115033,0.106875,0.135318,0.139563,0.150976,0.098285,0.485286,0.134758,0.0956,0.096365,0.117466,0.115648,0.120234,0.10649,0.097233,0.111238,0.471517,0.125006,0.121981,0.139149,0.261063,0.154871,0.080647,0.063662,0.060193,0.080198,0.125705,0.126508,0.122341,0.061873,0.296444,0.170842,0.083774,0.081671,0.075031,0.061481,0.072276,0.084269,0.081989,0.072301,0.099316,0.115865,0.106239,0.311213,0.251489,0.181395,0.069425,0.059898,0.086482,0.083021,0.122565,0.104579,0.124132,0.098393,0.395602,0.159557,0.179901,0.193142,0.216052,0.185782,0.07078,0.082155,0.244985,0.085125,0.220805,0.166942,0.054375,0,0,0,0.216589,0.103235,0.139177,0.128982,0.099726,0.1334,0.132158,0.09728,0.239664,0.208593,0.1033,0.116385,0.12264,0.078161,0.131731,0.135493,0.071147,0.080404,0.092666,0.048735,0.078518,0.099276,0.229499,0.085619,0.086207,0.045145,0.090733,0.075417,0.102002,0.14156,0.095881,0.095475,0.35864,0.205094,0.16766,0.262442,0.752905,0.206718,0.201289,0.246927,0.287964,0.313408,0.15764,0.390072,0.15406,0.18817,0.226314,0.236393,0.054101,0.086862,0.09689,0.052031,0.131056,0.135159,0.098398,0.098749,0.276787,0.28888,0.095197,0.085358,0.049169,0.092519,0.085637,0.053986,0.096706,0.075785,0.094623,0.127653,0.10172,0.12634,0.11708,0.28355,0.073142,0.0962,0.066832,0.072452,0.134132,0.103225,0.126917,0.093911,0.088412,0.110964,0.109208,0.064791,0.117139,0.105262,0.067145,0.124535,0.090054,0.087632,0.274715,0.196234,0.685946,0.157014,0.119207,0.423618,0.135222,0.106143,0.074128,0.118797,0.147709,0.119667,0.161923,0.106509,0.355875,0.121052,0.124381,0.038593,0.038275,0.03673,0.037319,0.037047,0.03682,0.039177,0.180895,0.157608,0.084107,0.084791,0.16982,0.207533,0.104622,0.096124,0.097912,0.100473,0.097846,0.10598,0.105675,0.064959,0.054104,0.053771,0.052258,0.05053,0.049607,0.049056,0.048219,0.047915,0.049372,0.070935,0.240632,0.05888,0.064241,0.061598,0.203172,0.11816,0.098018,0.051115,0.048655,0.047006,0.09715,0.096125,0.102165,0.05394,0.468481,0.141865,0.055363,0.054903,0.055818,0.053507,0.053025,0.05449,0.054063,0.054046,0.380689,0.076238,0.062251,0.06201,0.18848,0.150491,0.158323,0.060011,0.051858,0.072548,0.094423,0.094881,2.471993,0.412258,0.39038,0.171064,0.061739,0.05684,0.065406,0.294187,0.054813,0.102165,0.049475,0.051102,0.270545,0.322291,0.156481,0.163352,0.166867,0.061838,0.055394,0.051528,0.050347,0.049326,0.096296,0.100951,0.10248,0.05313,0.047907,0.312322,0.164064,0.091505,0.201953,0.66777,1.669108,0.247731,0.225839,1.300166,0.564047,0.939324,0.25321,0.373377,0.785902,0.467669,0.108866,0.105737,0.101486,0.085478,0.096251,0.101087,0.106446,0.05272,1.10548,0.109698,0.052493,0.051819,0.051813,0.0508,0.050543,0.051668,0.051122,0.05222,0.064733,0.165303,0.132737,0.172507,0.198555,0.111088,0.047579,0.049378,0.051161,0.049614,0.056379,0.049521,0.053757,0.048923,0.080595,0.054267,0.055349,0.056018,0.056506,0.053157,0.052743,0.052201,0.054528,0.053515,0.064722,0.270397,0.098835,0.112883,0.150201,0.092186,0.048369,0.048591,0.047261,0.048753,0.05662,0.05041,0.047737,0.048022,1.428842,0.085399,0.047429,0.046601,0.047922,0.046244,0.045867,0.046273,0.0461,0.074452,0.178862,0.070695,0.073585,0.070699,0.130116,0.119442,0.049785,0.047258,0.048545,0.046432,0.054303,0.049835,0.05512,0.108513,0.275895,0.143098,0.052529,0.052469,0.053447,0.05224,0.053726,0.052276,0.054317,0.05405,0.06765,0.058324,0.058527,0.098525,0.132498,0.14232,0.047077,0.044566,0.044763,0.043679,0.050902,0.05363,0.053195,0.047636,0.079176,0.04773,0.048231,0.047883,0.328134,0.089564,1.716236,0.646685,0.211497,0.391417,0.356321,1.088517,0.518564,0.171207,0.060328,0.177531,0.343959,0.292933,0.04761,0.21005,0.062555,0.21993,0.098509,0.613495,0.708976,0.146178,0.06215,0.131301,0.11342,0.047203,0.050842,0.242753,0.050459,0.050763,0.452309,0.556417,0.400565,0.1098,0.071602,0.234072,0.131648,0.331463,0.097563,0.077952,0.058663,0.212672,0.491296,0.418713,0.482653,0.314371,0.144026,0.55922,0.766428,0.142458,0.183849,0.153172,0.100357,0.268109,0.208348,0.124749,0.116506,0.264041,0.135822,0.395229,0.103376,0.101741,0.105145,0.277908,0.100677,0.101671,0.263742,0.050709,0.340941,0.427852,0.168751,0.355936,0.174434,0.104146,0.329104,0.099049,0.052992,0.280418,0.062469,0.057557,0.188003,0.068025,0.350824,0.117235,0.199887,0.045887,0.048121,0.246961,0.099914,0.095425,0.284964,0.056577,0.050538,0.049976,0.109743,0.189815,0.162823,0.125336,0.120102,0.117475,0.057886,0.069725,0.103278,0.162966,0.139847,0.514758,0.221551,0.105162,0.104356,0.106161,0.145247,0.058213,0.066013,0.058167,0.058622,0.054369,0.049252,0.267873,0.074678,0.049141,0.04829,0.048538,0.047204,0.047212,0.047356,0.052394,0.224273,0.170373,0.06854,0.066007,0.17619,0.176133,0.058142,0.050848,0.055302,0.055268,0.06302,0.055029,0.059732,0.05781,0.057951,0.189338,0.056052,0.052942,0.050373,0.050141,0.048696,0.047057,0.048918,0.221725,0.235752,0.060218,0.108203,0.106486,0.185267,0.12713,0.054376,0.049557,0.046922,0.0448,0.053683,0.046298,0.048429,0.053864,0.049995,0.033922,0.033003,0.034673,0.031835,0.026917,0.026245,0.0305,0.032672,0.033204,1.747649,1.534558,0.449109,0.245297,0.104935,0.09523,0.101548,0.047291,0.045887,0.045935,0.053235,0.040651,0.047763,0.350333,0.046993,0.044943,0.042691,0.048676,0.048944,0.048875,0.050926,0.102932,0.048012,0.042682,0.042882,0.046246,0.047069,0.047826,0.045858,0.046676,0.047336,0.039485,0.039846,0.04461,0.055744,0.045788,0.045855,0.038342,0.044073,0.048029,0.047055,0.046058,0.035165,0.047078,0.048588,0.053649,0.1781,0.050692,0.049356,0.04943,0.050629,0.041373,0.237206,0.124399,0.078564,1.270176,2.175433,2.148306,0.826874,0.048564,0.048202,0.042302,0.186047,0.109925,0.045519,0.049068,0.049173,0.048944,0.050659,0.049226,0.0427,0.189629,0.634102,0.073406,0.068444,0.066495,0.129223,0.109763,0.06602,1.216755,1.869815,0.052101,0.063052,0.053548,0.056648,2.271718,0.995165,0.065051,0.231785,0.190356,0.08172,0.049483,0.073097,0.041547,0.05077,0.053144,0.272691,0.656123,0.184484,0.161189,0.157225,0.184525,0.056804,1.249008,2.139079,1.846953,0.058541,0.04966,0.043485,1.367764,0.102444,0.052752,0.053099,0.044731,0.053009,0.052556,0.052346,0.041864,0.052549,0.09297,0.24427,0.085474,0.056857,0.060299,0.685362,0.189202,0.049024,1.256972,2.119459,1.583217,0.058013,0.052044,0.047103,1.302984,0.297135,0.081075,0.053519,0.054299,0.047146,0.051356,0.053351,0.052949,0.053952,0.060435,0.37671,0.062935,0.107825,0.056609,0.086258,0.200974,0.064574,1.240266,2.142995,0.510391,0.07511,0.065174,0.066244,0.62264,1.051858,0.044728,0.05124,0.049414,0.049628,0.049886,0.046855,0.043748,0.046706,0.051095,0.063993,0.219734,0.174228,0.170295,0.313113,0.234303,0.963611,0.985101,0.073555,0.047218,0.05968,0.098581,1.021765,2.958907,1.399528,0.141507,0.065645,0.064102,0.12452,0.059173,0.059081,0.055132,0.060002,0.240316,0.17746,0.227478,0.160196,0.144511,0.127869,0.227228,0.141629,1.204689,0.060748,0.063478,0.114154,0.837279,1.060742,0.113918,0.11354,0.345812,0.126219,0.047421,0.288741,0.084476,0.048875,0.147139,0.143155,0.173205,0.454304,1.194783,0.229946,0.124645,0.240947,0.139665,0.249007,0.339446,0.075468,0.049911,0.098795,0.098845,0.142559,0.101679,0.448164,0.159691,0.132476,0.102256,0.098193,0.083033,0.074507,0.073324,0.165047,0.089438,0.097936,0.173353,0.333414,0.134631,0.228085,0.141283,0.04668,0.039387,0.047452,0.050196,0.09667,0.094798,0.10641,0.052438,0.081764,0.039005,0.050361,0.050424,0.047246,0.045163,0.051453,0.05187,0.044015,0.187497,0.306928,0.302075,0.061933,0.058887,0.38253,1.156645,0.138379,1.235098,2.171406,1.094398,0.103797,0.102533,0.102479,0.089102,0.373408,0.09204,0.048103,0.048904,0.045154,0.046078,0.044597,0.048704,0.049136,0.072028,0.212918,0.138429,0.188664,0.113728,0.153547,0.178955,0.060152,0.991932,0.049745,0.049381,0.100961,0.104154,0.103395,1.45546,0.249514,0.102043,0.042823,0.032579,0.032452,0.031397,0.028736,0.029408,0.029834,0.031219,0.18046,0.827209,0.194727,0.11794,0.180533,0.113254,0.109097,0.286553,0.688524,0.061583,0.066774,0.063905,0.120157,0.714941,0.268201,0.075269,0.049632,0.047584,0.048202,0.048177,0.047559,0.049771,0.050254,0.099141,2.210687,1.314644,0.437397,0.18165,0.184128,0.111843,0.099917,1.204478,0.054655,0.053788,0.061648,0.051708,0.058598,0.264507,0.112337,0.054931,0.047698,0.047235,0.047622,0.048217,0.05024,0.097927,0.049784,0.144017,0.093027,0.06105,0.091942,0.235028,0.18073,0.06433,0.060969,1.230457,0.213398,0.062125,0.06071,0.070256,1.590699,1.017569,0.203343,0.263078,0.160016,0.171362,0.077872,0.154823,0.172764,0.155857,0.056656,0.060805,0.154407,0.976585,0.445294,2.240357,0.418366,0.226628,0.382237,0.176304,0.267213,0.171982,0.052162,0.055383,0.805299,0.320502,0.054519,0.20096,0.049628,0.04851,0.051211,0.05062,0.049066,0.16725,0.115358,0.072126,0.093029,0.420831,0.159712,0.115648,0.134409,0.273367,0.195548,1.14064,0.060901,0.062329,0.060734,0.069856,0.096305,0.112018,0.070682,0.071068,0.061485,0.05989,0.061673,0.061514,0.061587,0.061727,0.060811,0.062749,0.065965,0.067552,0.525765,0.188766,0.275216,0.271946,0.780136,0.876294,0.099391,0.056774,0.058284,0.067548,0.063685,1.841297,1.186044,1.139751,0.280849,0.070089,0.066123,0.06449,0.06436,0.06373,0.062698,0.070971,0.118313,0.27458,0.084341,0.073185,0.071132,0.235919,0.100009,0.936537,0.106881,0.108598,0.095997,0.069374,0.061593,0.065109,0.243287,0.84114,0.119434,0.067697,0.062996,0.062041,0.061609,0.061505,0.060924,0.06531,0.071372,0.931938,0.236936,0.127987,0.127354,0.200035,0.137951,0.106523,0.110424,0.10577,0.105814,0.102576,0.106316,0.107199,0.121514,0.057084,0.045705,0.046811,0.049155,0.048333,0.046335,0.046281,0.047731,0.05088,0.060273,0.077093,0.102652,0.064901,0.309146,0.913132,0.156128,0.840522,0.090989,0.088272,0.086711,0.135188,0.132824,0.423834,1.059311,0.373409,0.054687,0.048957,0.048267,0.048292,0.047718,0.051455,0.096595,0.099049,0.075826,0.058842,0.314413,0.228853,0.108612,0.106934,0.061009,1.244928,1.091984,0.047155,0.046884,0.101113,0.100325,0.099317,0.052903,0.728433,0.367348,0.154843,0.100796,0.156013,0.20038,0.109685,0.18524,0.433782,0.87913,0.295234,0.185317,0.229409,0.356576,0.107394,0.069746,1.27459,1.988189,0.055275,0.054992,0.063897,0.055395,0.074764,0.337483,0.104839,0.055445,0.054978,0.053662,0.056109,0.046975,0.052007,0.054944,0.055442,0.061866,0.082968,0.634175,0.146117,0.714021,0.461954,0.236867,1.468806,2.122031,0.519828,0.0547,0.064912,0.063305,0.062942,0.382195,0.306759,0.140893,0.055184,0.055317,0.056366,0.054553,0.047758,0.051686,0.05568,0.06538,0.076873,1.592202,0.217387,0.226355,0.356057,0.083128,1.209046,1.923131,0.047143,0.049996,0.060638,0.05604,0.055487,0.647157,0.052993,0.048983,0.049996,0.05343,0.053518,0.051221,0.0485,0.048298,0.053562,0.064115,0.27975,0.149617,0.054863,0.059359,0.163215,0.171946,1.295326,2.117642,0.693786,0.064115,0.064486,0.06894,0.06098,1.259501,0.175554,0.17852,0.059354,0.053925,0.053808,0.054214,0.04947,0.048538,0.056415,0.061952,0.225236,0.077082,0.108646,0.062295,0.061407,0.223017,1.218168,1.444574,0.052196,0.051568,0.055543,0.048895,0.055929,0.05495,0.106544,0.052405,0.053046,0.050382,0.048806,0.049885,0.051693,0.053172,0.052498,0.061194,0.34165,0.168417,0.310838,0.198191,0.068191,0.060216,1.242124,0.801813,0.054835,0.059706,0.074494,0.062366,0.061106,0.138793,0.366815,0.126626,0.091478,0.05436,0.098034,0.280665,0.084248,0.1937,0.215987,0.711833,2.187249,0.406484,1.129821,0.335147,0.116755,0.258673,1.32339,2.145428,0.485424,0.061973,0.066895,0.058984,0.063617,0.065838,0.068256,0.355628,0.266792,0.055062,0.054808,0.052747,0.052382,0.051948,0.874168,0.093146,0.139294,0.063191,0.05971,0.05966,0.175132,0.141932,1.243821,1.410708,0.050958,0.049228,0.056615,0.234562,1.171801,0.192176,0.143572,0.170181,0.168171,0.126948,0.054924,0.055097,0.048222,0.049779,0.054502,0.067372,0.062316,0.056146,0.079311,0.118285,0.270057,0.118361,1.256778,2.165966,0.628326,0.063687,0.062916,0.063916,1.477845,0.062956,0.287638,0.256569,0.098901,0.062949,0.061841,0.056142,0.064325,0.06429,0.061323,0.057744,0.214148,0.369251,0.294829,0.10579,0.268611,0.113628,1.232689,2.161412,0.111226,0.0641,0.071019,0.060673,0.062439,0.66868,0.062297,0.056416,0.054792,0.061103,0.060708,0.062016,0.061762,0.052608,0.063675,0.068632,0.287033,0.072097,0.073527,0.073599,0.071466,0.156851,1.209699,2.13393,0.922111,0.048533,0.108532,0.109357,0.110997,0.807515,0.205523,0.152358,0.059384,0.061283,0.059526,0.052101,0.061177,0.060383,0.061715,0.145392,0.119595,0.126428,0.081641,0.066108,0.212474,0.178446,1.256631,2.1761,1.467756,0.059057,0.108605,0.11199,0.105034,0.061079,0.062352,0.060042,0.963199,2.083309,0.171691,0.15686,0.102157,0.05599,0.117474,0.070895,0.08846,1.254777,0.246682,0.173714,0.137913,0.095477,1.256806,1.657753,0.051476,0.050418,0.102125,0.099403,1.28632,0.27282,0.128349,0.276013,0.14835,0.218902,0.125574,0.386726,0.348649,0.137028,0.063801,0.153471,0.591464,0.092946,0.522901,0.903618,0.061663,0.051487,1.213482,1.583516,0.049619,0.049535,0.05086,0.0428,0.0536,0.629881,0.048297,0.058717,0.157572,0.057095,0.057408,0.150838,0.058184,0.058591,0.064161,0.395339,1.32242,0.251703,0.264731,0.16938,0.104714,0.072034,1.245067,2.002431,0.069694,0.070638,0.075666,0.059138,0.058648,0.055654,0.103998,0.165366,0.052812,0.046418,0.047516,0.047297,0.048079,0.045152,0.050799,0.057266,0.059114,0.066848,0.054669,0.051721,0.160675,0.169782,1.227332,2.158684,0.28512,0.043947,0.055923,0.051124,0.047609,0.254354,0.049426,0.052417,0.048282,0.040635,0.043809,0.049088,0.049057,0.045871,0.051741,0.143632,0.298809,0.09349,0.06136,0.062371,0.059818,0.190993,1.315454,2.130921,2.027167,0.046376,0.055827,0.040391,0.046732,0.050067,0.254967,0.048865,0.059655,0.0627,0.060919,0.053717,0.062409,0.061896,0.05967,0.070395,0.157267,0.371292,0.080159,0.058361,0.060005,0.132554,1.335602,2.162171,1.552169,0.039274,0.049993,0.050576,0.044381,0.658883,0.127014,0.2776,0.036527,0.049214,0.049677,0.036578,0.050431,0.046591,0.04996,0.061155,0.216407,0.051495,0.059137,0.100102,0.225925,0.886903,1.289568,2.156746,2.100596,0.031831,0.057437,0.034098,1.340798,1.006794,0.054292,0.036782,0.036483,0.055944,0.037728,0.052107,0.03659,0.044105,0.055198,0.184445,2.192585,1.575157,0.448126,0.191372,0.05728,0.160699,2.03349,2.139219,2.110008,0.640943,0.042669,0.048127,0.042162,0.99677,0.472466,0.325591,0.05198,0.055705,0.591146,0.96696,0.049235,0.044046,0.053008,0.091832,0.049413,0.094649,0.047417,0.095497,0.234245,0.119564,1.278751,2.155087,2.136709,1.174306,0.097981,0.05887,1.145231,0.664159,0.05603,0.144729,0.653818,0.312795,0.069599,0.19686,0.047442,0.036921,0.057515,0.058519,0.051667,0.059675,0.049463,0.058758,0.089792,0.167951,1.426552,2.121723,2.115596,0.802959,0.06289,0.044851,0.709807,1.069784,0.278823,0.056385,0.044418,0.058081,0.050712,0.054746,0.056159,0.059756,0.090449,0.112909,0.254959,0.351701,0.355625,0.225819,0.157511,0.182651,1.213531,2.147851,2.065197,0.678851,0.064305,0.059314,0.752253,0.992727,0.069497,0.054068,0.044732,0.054563,0.056745,0.046254,0.052655,0.057723,0.052667,0.064593,0.057442,0.130759,0.220268,0.167953,0.449635,0.301359,1.221901,2.132999,2.102092,1.26287,0.063629,0.044985,0.058851,0.047085,0.057751,0.053609,0.04987,0.056905,0.046495,0.056667,0.04775,0.057667,0.057268,0.061084,0.061719,0.077041,0.070889,0.061295,0.073188,0.132504,1.408348,2.152167,2.127307,1.876289,0.066758,0.050506,0.410068,1.420022,0.285397,0.13325,0.056452,0.04678,0.056218,0.045823,0.055953,0.048241,0.060588,0.138442,0.303433,0.147786,0.07509,0.063397,0.082805,0.123666,0.212626,0.053999,0.041805,0.055543,0.049995,0.054707,0.050047,0.073295,0.089054,0.052475,0.038225,0.052733,0.039099,0.045952,0.044358,0.040952,0.060776,0.051076,0.151068,0.108607,0.586322,1.556897,2.216851,0.827618,0.140866,0.07929,0.037942,0.053115,0.048111,0.056032,0.965398,0.598579,0.171557,0.975659,0.060943,0.05287,0.041916,0.050521,0.043059,0.050137,0.049903,0.070692,0.206271,1.361695,0.867148,0.180626,0.735402,0.51376,0.039773,0.051384,0.039197,0.047821,0.05643,0.869087,2.25151,1.110444,0.6948,0.789488,1.138752,0.916718,0.274121,0.055941,0.058174,0.065135,0.077587,0.063431,0.106565,0.062456,0.054336,0.063009,0.090667,0.23057,0.089163,0.045262,0.050722,0.041167,0.056332,0.044689,0.057145,0.770597,0.058858,0.871098,0.091656,0.047962,0.054273,0.043476,0.055511,0.043462,0.058473,0.097391,0.427683,0.058484,0.053785,0.059651,0.363508,0.21825,0.055432,0.03886,0.050221,0.038797,0.059905,0.039738,0.05328,0.041348,0.059595,0.045958,0.045021,0.053535,0.041243,0.056079,0.043162,0.058832,0.050896,0.058684,0.058895,0.157821,0.306711,0.40846,0.271387,0.092513,0.081798,0.086694,0.117366,0.139091,0.165223,0.155753,0.154387,0.746652,0.991521,1.680041,0.043143,0.038065,0.055122,0.036954,0.041828,0.051103,0.046832,0.988581,1.211534,1.07787,1.026235,1.028665,0.740363,0.316923,0.133352,0.095696,0.078944,0.09232,0.093587,0.21918,1.032057,0.700673,0.075105,1.035602,0.061123,0.051006,0.05444,0.057507,0.050258,0.06222,0.191403,0.976853,1.100741,0.220596,0.053868,0.833993,1.123332,0.792258,0.051805,0.05808,0.049068,0.059068,0.057132,0.193027,0.985859,0.673759,0.050834,0.059349,0.110156,0.064604,0.037629,0.052699,0.037229,0.053715,0.047477,0.061149,0.049059,0.056865,0.052763,0.05371,0.054667,0.038058,0.051241,0.035369,0.051274,0.036403,0.059727,0.035709,0.051182,0.035471,0.048948,0.03828,0.044666,0.046088,0.040244,0.04747,0.03611,0.050981,0.046332,0.061285,0.050686,0.061911,0.049935,0.059589,0.048387,0.052495,0.034236,0.048384,0.034369,0.050373,0.04446,0.038197,0.045153,0.034386,0.0512,0.035356,0.051331,0.036334,0.045929,0.04258,0.035625,1.674523,2.013732,2.014923,1.472022,0.231806,0.063827,0.054945,0.063622,0.158031,0.324779,0.082974,0.037458,0.052943,0.045414,0.654243,0.914497,0.051042,0.045806,1.904387,0.048278,0.045917,0.041358,0.051,0.053975,0.882268,1.916617,1.394403,1.540819,0.11576,0.060391,0.056471,0.198138,0.050953,0.046471,0.042602,0.043751,0.045662,0.057745,0.034183,0.050395,0.039938,0.048252,0.040575,0.066611,0.041408,0.047085,0.042784,0.046639,0.038629,0.594262,2.024209,1.920242,1.554286,1.295117,0.774331,0.288156,0.088734,0.048818,0.03411,0.050219,0.045121,0.045636,0.049014,0.180942,1.256462,0.044213,0.063783,0.069842,0.057871,0.046124,0.057725,0.046219,0.62668,1.125501,0.964799,1.382687,1.071175,0.558611,0.33694,0.237631,0.046056,0.054507,0.056377,0.042061,0.055976,0.052055,0.058413,0.056863,0.595849,1.406996,0.249071,0.049435,0.052366,0.045439,0.046372,0.053188,0.038086,0.051456,0.399588,1.103327,0.058694,0.055994,0.577086,0.536447,0.051912,0.053497,0.055402,0.049063,0.108131,0.045518,0.046179,0.039523,0.329501,0.363647,0.036303,0.053882,0.036877,0.054398,0.03792,0.040704,0.047559,0.508221,1.963054,1.983569,2.480681,1.217262,1.190429,0.970454,0.167471,0.080626,0.040367,0.05758,0.041017,0.067721,0.275416,0.246089,1.174205,0.318912,1.700182,1.622997,1.697712,1.650873,1.147516,0.247765,3.007239,1.086325,0.584281,1.61305,0.47012,0.06265,0.06358,0.053744,0.111431,0.292743,0.054652,0.052756,0.056168,0.226712,0.160513,0.152459,2.031091,0.160931,0.117499,0.532632,1.944784,2.16123,1.631461,2.012176,0.202188,0.04967,0.061899,0.109369,0.219228,0.842713,1.26833,0.283325,0.098906,0.104607,0.096205,0.107377,0.096618,0.097005,0.298926,0.159854,2.005282,0.229877,1.970054,0.110533,0.207697,0.169307,0.198359,0.284717,0.221829,0.232751,0.309807,0.247227,0.237747,0.303964,0.275564,0.285525,0.380229,0.048168,0.046237,0.048825,0.038891,0.095505,0.557205,2.034444,2.017027,2.184182,0.964184,0.05273,0.055705,0.048036,0.055338,0.04695,0.049986,0.520425,1.928234,2.014288,2.004542,0.084621,0.072181,0.065649,1.682297,0.378774,0.039338,0.04918,0.033699,0.104081,0.094973,0.099956,0.049512,0.067171,0.058184,0.04142,0.040041,0.057116,0.040619,0.048784,0.049612,0.049031,0.060711,0.057041,0.051869,0.063354,0.102926,0.357946,0.204172,0.043623,0.044568,0.035475,0.051777,0.096501,0.718341,2.002854,1.117676,0.055162,1.849819,0.116665,0.054983,0.042636,0.057191,0.041322,0.061211,1.917801,1.195368,0.318355,0.1191,0.158954,0.162099,0.197758,0.264357,0.135651,0.05247,0.035741,0.0505,0.096711,0.105018,0.098336,0.054977,0.043669,0.047164,0.047542,0.040997,0.05794,0.039787,0.178067,0.051614,0.02636,0.025366,0.048006,0.024907,0.025052,0.047455,0.027278,0.020531,0.027426,0.030089,0.016512,0.016171,0.040065,0.017155,0.016188,0.016514,0.040962,0.016125,0.01603,0.015549,0.042178,0.016093,0.015976,0.022708,0.050644,0.026081,0.025231,0.024561,0.049124,0.025816,0.025311,0.019426,0.034576,0.026007,0.016701,0.016449,0.016511,0.044923,0.015935,0.016685,0.01584,0.015336,0.033381,0.027728,0.015781,0.016161,0.015718,0.03774,0.037024,0.026006,0.026383,0.026343,0.036856,0.041829,0.026111,0.020775,0.016556,0.026283,0.036448,0.016957,0.01735,0.01722,0.030748,0.032207,0.016473,0.016604,0.016662,0.04353,0.019049,0.016918,0.016913,0.033233,0.041498,0.026434,0.0266,0.026284,0.05112,0.02564,0.025936,0.020795,0.045853,0.016707,0.01698,0.01724,0.034188,0.02669,0.016843,0.017056,0.022687,0.038918,0.017286,0.017164,0.016953,0.043381,0.016996,0.023714,1.664883,1.459208,1.775382,1.682988,1.705188,2.28004,1.514387,1.110473,0.242729,0.060264,0.040737,0.058113,0.051994,0.058804,0.044473,0.063021,0.07518,0.697023,0.604631,0.061449,0.052392,0.073512,0.110701,0.109491,0.196757,0.356603,0.858011,1.600511,0.576876,0.118457,0.339214,0.25483,0.205081,0.043652,0.038764,0.053954,0.046283,0.042637,0.053601,0.038226,0.084415,0.102035,2.163531,1.349087,0.323382,0.450518,0.706122,0.637607,0.659441,1.000636,0.922904,0.199837,0.068555,0.05614,0.159938,0.221499,0.047569,0.052082,0.055415,0.044077,0.072325,0.050193,0.056999,0.045396,0.903843,0.44785,0.105467,0.048263,0.054936,0.040944,0.05548,0.05108,0.06273,0.05341,0.061189,0.052053,0.063344,0.066652,0.465683,0.167517,0.127354,0.105385,0.1039,0.094231,0.104525,0.095169,0.106217,0.098865,0.452219,1.992232,1.349472,0.255558,0.079023,0.13535,0.079499,0.050623,0.428403,1.295857,1.145338,1.872796,1.226276,0.501528,0.660503,0.705626,0.143416,0.047876,0.04273,0.039489,0.098589,0.101018,0.094508,0.053534,0.048474,0.03609,1.083381,1.027821,0.052719,0.048968,0.130788,0.170449,0.125178,2.093115,1.729274,0.133974,0.085658,0.106447,0.056021,0.192219,0.264097,0.195348,0.062229,0.034528,0.099963,0.096215,0.098435,0.050568,0.459318,1.529152,0.522504,0.054621,0.052693,0.042562,0.050145,0.099392,1.268324,2.067926,1.786371,1.97481,1.112823,1.014126,0.631781,0.318303,0.320493,0.097715,0.090753,0.095657,0.138146,0.145209,1.03993,1.051769,0.95083,0.647433,0.131147,0.04192,0.05235,0.052494,0.038994,0.059093,0.051506,0.059738,0.398474,1.053394,0.997079,0.50598,0.302178,0.228036,0.048856,0.0489,0.04854,0.050855,0.092056,0.102316,0.106845,0.040773,0.05257,1.280433,1.173096,0.08151,0.063581,0.041595,0.049806,0.058705,0.051737,0.061803,0.286839,1.755793,1.556382,1.437987,0.790507,0.969401,0.050815,0.047522,0.047851,0.041538,0.093745,0.102686,0.102957,0.045118,0.052696,0.067019,0.117374,0.090387,0.058351,0.044458,0.054987,0.056296,0.104224,0.175102,0.096675,0.139134,0.163213,0.16823,0.171797,0.327441,0.106618,0.083533,0.080969,0.113523,0.120204,0.134842,0.130049,0.09055,0.3142,1.469168,0.178395,0.05029,0.053803,0.040792,0.055492,0.049147,0.062047,0.051813,0.746178,1.557547,1.511848,0.788501,0.314912,0.14241,0.120381,0.132061,0.133694,0.112349,0.167421,0.172454,0.226689,0.125037,0.117353,0.109726,0.421973,0.597015,0.494005,0.11862,0.115462,0.143861,0.253105,0.693198,0.473238,1.656907,0.572854,1.429965,0.360003,0.107784,0.082623,0.10227,0.104335,0.054651,0.093971,0.103701,0.099768,0.047854,0.690277,1.172292,1.661574,1.046885,0.135348,0.149533,0.291795,0.422867,0.355378,0.301076,0.162507,0.595379,1.098726,0.7049,0.528951,0.324393,0.132575,0.157916,0.156237,0.146183,0.212647,0.199574,0.20773,0.165831,0.915862,0.340426,0.055545,0.040623,0.055673,0.040665,0.05424,0.047944,0.063005,0.053424,0.64962,1.142915,1.334151,1.115785,0.268993,0.144094,0.052694,0.037953,0.04931,0.046953,0.092948,0.10118,0.096044,0.055208,0.048447,0.047362,0.049349,0.041832,0.051151,0.03821,0.052611,0.04815,0.061133,0.055828,0.121757,0.057019,0.056676,0.108116,0.591888,0.21805,0.040139,0.046606,0.049871,0.034498,0.101882,0.09396,1.254939,1.913607,1.375617,0.867616,0.230843,0.162528,0.151632,0.174451,0.301406,0.050112,0.370958,0.060073,0.87254,0.105982,0.20318,0.069412,0.299971,0.361667,0.082462,0.18897,0.21786,0.047213,0.393116,0.099744,0.1015,0.476453,1.011268,0.367017,0.050688,0.231971,0.115083,0.051127,0.208162,0.045907,0.059599,0.192327,0.0538,1.377988,1.078153,0.930029,0.507358,0.255527,0.139931,0.237248,0.232915,0.045942,0.095737,0.304188,0.099687,0.05047,0.046173,0.057143,0.047761,0.048102,0.048587,0.050729,0.044449,0.053248,0.060406,0.058303,0.063081,0.329427,0.45239,0.101182,0.05602,0.102274,0.048841,0.105695,0.054658,0.060641,0.110082,0.11072,0.103959,1.348313,0.222909,0.121352,0.078042,0.390357,0.269313,0.163532,0.048305,0.042694,0.052916,0.054298,0.130388,0.303185,0.776668,0,0,0.125542,0.0673,0.063319,0.062793,0.060472,0.095169,0.101055,0.105143,0.060544,1.522925,0.670861,1.118926,0.099412,0.063388,0.059873,0.06444,0.072764,0.259157,0.884635,0.594598,0.027789,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.081786,0.059234,0.059756,0.356326,0.345452,0.056767,0.051159,0.0441,0.048151,0.098823,0.099925,1.053519,1.251432,0.144208,0.050798,0.041688,0.052042,0.049063,0.043041,0.052962,0.048665,0.06048,0.059174,0.739329,0.069639,0.060447,0.052763,0.295007,0.214031,0.063957,0.048951,0.041886,0.051938,0.092049,0.105768,0.097126,0.062438,2.961274,1.002393,0.380915,0.106972,0.095901,0.101357,0.091197,0.10598,0.093433,0.107898,0.09645,0.351891,0.809483,0.441779,0.562904,0.545437,0.091907,0.056216,0.058235,0.058029,0.105499,0.101988,0.109188,1.38573,1.630549,0.602178,0.053702,0.041051,0.050807,0.046431,0.046792,0.058393,0.052398,0.215178,0.968611,0.479104,0.059751,0.054821,0.056701,0.059727,0.311276,0.049739,0.045764,0.041282,0.101945,0.094295,0.104755,0.042322,0.061506,0.039585,0.052134,0.039239,0.053282,0.039629,0.054421,0.04815,0.063316,0.585395,1.291026,1.708204,1.605409,1.496703,0.408004,0.3093,0.093884,0.04952,0.049502,0.038554,0.098035,0.100833,0.097974,1.783145,0.668549,0.131738,0.844318,0.836083,0.629275,0.04071,0.054118,0.185675,0.859594,1.103408,1.279749,1.531264,0.971655,1.119644,0.945681,0.299757,0.048065,0.048737,0.050536,0.049945,0.100325,0.095154,0.101785,0.052638,1.295056,1.872034,0.423469,0.061587,0.134497,0.44502,0.373454,1.311442,1.682086,0.794729,0.850125,0.809544,0.809307,0.274239,0.34194,0.177507,0.073758,0.060385,0.058915,0.058483,0.107003,0.10305,0.103573,1.844374,0.062548,0.053245,0.04303,0.053868,0.052645,0.042924,0.054249,0.056397,0.054552,0.062212,0.052048,0.062061,1.317097,1.029454,0.717691,0.057276,0.047004,0.043434,0.052089,0.042913,0.097444,0.104093,0.097237,0.358651,1.264765,0.305261,0.126609,0.050731,0.039268,0.052707,0.048285,0.050752,0.060419,0.0536,0.060304,0.160878,0.116824,0.125787,0.12466,0.254874,0.143112,0.117544,0.131168,0.097854,0.125746,0.135344,0.138077,0.061627,0.070214,0.058367,0.050703,0.050024,0.040367,0.050568,0.041985,0.057921,0.060236,0.052077,0.933309,1.31508,2.105481,1.636159,1.519953,1.400995,0.527978,0.094643,0.062126,0.060208,0.099259,0.108169,0.106513,2.574902,2.006297,0.314632,0.059221,0.043796,0.048837,0.054091,0.044045,0.058062,0.060416,0.054174,0.662799,0.072124,0.059392,0.050688,0.211005,0.245766,0.065871,0.045594,0.041771,0.051155,0.094685,0.104972,0.094919,0.05806,0.044965,0.051611,0.037171,0.051658,0.038608,0.052061,0.039606,0.055194,0.053194,0.056291,0.055936,0.053346,0.061102,0.157241,0.350718,0.08783,0.057198,0.086889,0.0879,0.101145,0.090103,0.102557,0.089262,1.266686,3.301132,0.068855,0.05609,0.061302,0.054839,0.063866,0.058075,0.065298,0.061325,0.26793,0.680294,0.063391,0.062277,0.059788,0.064697,0.129997,0.162547,0.053496,0.058292,0.054743,0.107399,0.096931,0.099393,0.154022,0.053699,2.127368,1.670591,0.906352,2.243116,2.401691,0.099928,0.055938,0.050695,0.062828,1.026985,1.411322,1.04594,0.46802,0.171895,0.148876,0.129097,0.157307,0.151604,0.145166,0.212165,0.183668,0.189745,0.144983,0.351238,0.491534,0.042257,0.048984,0.043636,0.048739,0.322311,0.120857,1.200247,1.216407,1.24419,0.187243,0.06513,0.07679,1.018375,0.972271,0.176741,0.098175,0.046329,0.048319,0.09768,0.097946,0.098644,0.043752,0.189839,0.046391,0.053266,0.039199,0.044933,0.04913,0.040412,0.05932,0.05016,0.652352,1.994778,1.981549,1.825824,1.10342,1.050021,0.331858,0.059294,0.04411,0.049285,0.0378,0.104627,0.096865,0.968988,2.878322,0.847151,0.604519,0.038262,0.052418,0.038978,0.05174,0.040844,0.056155,0.055639,0.891088,1.503138,0.146517,0.0619,0.093672,0.06202,0.056558,0.119949,0.05373,0.054914,0.044977,0.100859,0.097352,0.107958,0.049242,0.108913,0.041127,0.048808,0.046555,0.047311,0.049568,0.044517,0.05705,0.052609,0.062177,0.183606,0.077434,0.054568,0.058309,0.055917,0.172887,0.049973,0.039621,0.051215,0.040974,0.09709,0.105309,0.097552,0.054369,0.220536,0.173226,0.050159,0.041741,0.051017,0.052125,0.039819,0.058325,0.057985,0.059553,0.823759,0.045686,0.048517,0.106746,0.186045,0.04905,0.04482,0.050627,0.050115,0.041226,0.095942,0.095913,0.093258,0.052499,0.403156,0.113154,0.060796,0.057281,0.062208,0.059648,0.056026,0.062563,0.062707,0.059135,0.085414,1.721102,1.402243,0.561368,0.195212,0.04681,0.046574,0.047222,0.045913,0.044353,0.055671,0.043595,0.04132,0.046402,1.115715,3.073752,0.363453,0.059449,0.059343,0.111096,0.059002,0.058595,0.060202,0.064603,0.129678,0.308696,0.293437,0.306191,0.279468,0.937808,0.067799,0.054131,0.050805,0.04828,0.055897,0.04695,0.047643,0.046903,0.24753,0.057763,0.051974,0.052908,0.056044,0.050253,0.045167,0.057572,0.060234,0.060807,0.585876,0.616168,0.730507,1.217311,0.140098,0.132979,0.050599,0.049787,0.049819,0.050176,0.058644,0.051974,0.046088,0.051265,0.120473,0.046896,0.043805,0.050169,0.04042,0.049871,0.04862,0.040763,0.052381,0.042594,0.508169,0.115161,0.060304,0.16045,0.194528,0.178005,0.04208,0.047394,0.050531,0.042928,0.052178,0.061133,0.042758,0.054027,0.299659,0.228286,0.078104,0.050883,0.039911,0.049914,0.049734,0.047041,0.06018,0.052301,0.352327,0.740562,0.21248,0.206657,0.177303,0.05903,0.046388,0.044686,0.051576,0.044922,0.055041,0.052995,0.041551,0.273073,2.769776,0.691325,0.058185,0.061621,0.173394,0.158647,0.061952,0.191431,0.19529,0.372952,0.541679,0.188386,0.097594,0.238183,0.141542,0.546096,0.090987,0.050968,0.177496,0.176483,0.059018,0.352979,0.038729,0.056525,0.074029,0.359136,0.051201,0.04691,0.041083,0.164539,0.047966,0.184523,0.04966,0.052164,0.291359,0.087695,0.102815,0.212099,0.060313,0.583507,0.099261,0.049097,0.248581,0.048033,0.045913,0.248439,0.06031,0.170375,0.200504,0.04928,0.049158,0.179217,0.048068,0.21343,0.043985,0.048647,0.351506,0.05732,0.048382,0.059889,0.437254,0.052826,0.056243,0.054175,0.04386,0.039909,0.368033,0.042192,0.045655,0.048637,0.040783,0.422086,0.048367,0.035227,0.047245,0.049082,0.03579,0.353474,0.048162,0.047729,0.217255,0.306163,1.178995,1.77542,1.905464,1.552893,1.163063,1.209362,0.088241,0.187141,0.04838,0.171922,0.059363,0.352067,0.053193,0.047138,0.080011,0.438938,0.041404,0.043918,0.294583,0.050032,0.035437,0.060523,0.261865,0.259047,0.544089,0.288421,0.072986,0.072536,0.223619,0.340216,0.043619,0.0487,0.203633,0.04352,0.052663,0.230145,0.040675,0.067129,0.265826,0.045724,0.05175,0.040617,0.364729,0.043661,0.050037,0.056508,0.055135,0.68731,0.24576,0.176688,0.064435,0.448226,0.278807,0.085292,0.039434,0.223516,0.042929,0.046341,0.215565,0.042194,0.214888,0.903021,0.900853,0.224214,0.038743,0.052237,0.202783,0.05249,0.340394,0.053682,0.062909,0.052055,0.32915,0.229088,0.185693,0.366647,0.171732,0.221521,0.346248,0.088976,0.099574,0.268345,0.090234,0.108054,0.369162,0.08504,0.114856,0.249803,0.299108,0.051916,0.045095,0.211426,0.052094,0.048832,0.210518,0.145816,0.373091,0.290034,0.100044,0.102321,0.063105,0.245149,0.208912,0.055476,0.19916,0.058419,0.064295,0.392649,0.056893,0.07589,0.063465,0.046856,0.303834,0.043114,0.0491,0.044512,0.054414,0.187492,0.06228,0.083691,0.365161,1.567556,1.863622,0.119401,0.565584,0.060493,1.197207,1.791502,0.411436,0.157909,0.151642,0.215101,0.051784,0.065418,0.103252,0.121866,0.458382,0.572972,0.139779,0.207621,0.617717,0.383601,0.055185,0.056863,0.144714,2.349291,1.169746,0.373246,0.146607,0.124496,0.928676,0.359311,0.171067,1.011229,0.057702,0.042256,0.052274,0.041892,0.049338,0.129204,0.066239,0.052895,0.052443,0.258177,0.425651,2.042903,1.727364,0.159153,0.128923,0.172744,0.118263,0.15267,0.287466,0.16862,1.257395,0.820457,0.263375,0.166672,0.3177,0.094387,0.105885,0.051689,0.046151,1.078358,2.034415,1.101955,1.132275,1.006366,1.12761,0.837124,0.527966,0.126032,0.068262,0.191282,0.639348,0.646941,0.229277,0.189279,1.196685,0.906953,0.258867,0.203004,0.227435,0.099301,0.105073,0.340304,0.044987,0.891818,0.226466,0.069802,0.106654,0.058232,0.042804,0.055106,0.047014,0.061641,0.716112,0.115318,0.062835,0.126929,0.316686,0.095062,0.053249,0.039849,0.051454,0.042091,0.101259,0.354452,0.098571,0.060903,0.401564,0.044669,0.047664,0.052878,0.221002,0.288912,0.040964,0.052833,0.042595,0.121983,0.196487,0.367804,0.108019,0.104033,0.300147,0.165853,0.059673,0.052133,0.044709,0.295804,0.101248,0.098614,0.103746,0.210744,0.360419,0.102362,0.05093,0.045237,0.054209,0.213552,0.047726,0.052094,0.298277,0.20962,0.430544,0.313461,0.103518,0.202571,0.061314,0.171851,0.209838,0.051448,0.049924,0.210057,0.102877,0.101363,0.304432,0.054366,0.050017,0.297864,0.050596,0.044859,0.046003,0.19926,0.041101,0.048097,0.053242,0.561794,0.179845,0.185923,0.164221,0.05311,0.187461,0.272831,0.268184,0.101241,0.33042,0.103855,0.097925,0.103719,0.221551,0.051892,0.23541,0.060261,0.302496,0.161066,0.155433,0.329046,0.32205,1.119857,0.160213,0.404993,0.572768,0.179842,0.220324,0.061087,0.173725,0.059895,0.171634,0.202626,0.045719,0.237903,0.096707,0.094184,0.201217,0.053635,0.991126,0.772987,0.095298,0.051491,0.043268,0.756247,0.105958,0.28504,0.172484,0.942472,1.619267,1.37099,0.632454,0.246927,0.361629,0.36957,0.216402,0.059225,0.357149,0.064079,0.103096,0.316406,0.106072,0.06437,0.202344,0.057432,0.051009,0.169093,0.050584,0.210821,0.045557,0.148003,0.110807,0.055856,0.393528,0.208758,0.053538,0.247348,0.197667,0.194811,0.061429,0.184392,0.062656,0.215513,0.107374,0.295778,0.10554,0.051663,0.411892,0.250975,0.050134,0.04532,0.1611,0.045134,0.200922,0.042137,0.255133,0.0513,1.835196,2.564983,1.470682,0.782234,1.034191,0.410262,0.168769,0.039144,0.183463,0.048825,0.417444,0.102107,0.10064,0.046976,0.052554,0.353994,0.076459,0.04694,0.197022,0.05345,0.202242,0.052974,0.04365,0.481007,0.21262,0.208943,0.106345,0.341819,0.077453,0.190511,0.050536,0.367059,0.04562,0.047161,0.096315,0.10392,0.330634,0.052399,0.68902,0.534268,0.038411,0.051672,0.039391,0.248845,0.038138,0.053019,0.041997,0.31832,0.456128,0.121559,0.057816,0.247091,0.056069,0.138128,0.432122,0.038897,0.05122,0.039105,0.233517,0.094747,0.317735,0.043273,0.076644,0.037208,0.246787,0.041968,0.041425,0.050721,0.233939,0.052417,0.041182,0.404146,0.167873,0.060012,0.050434,0.063067,0.422555,0.115211,0.090106,0.105372,0.225588,0.078508,0.093246,0.27078,0.095826,0.055747,0.498429,0.908672,0.093502,0.06639,0.242873,0.06641,0.056858,2.089412,2.085359,0.173624,0.120738,1.820134,0.864776,0.260826,0.524257,0.296153,0.140463,0.145146,0.153575,0.283967,0.204854,0.189142,0.182621,0.334849,1.54184,1.743131,0.046384,0.285609,1.607825,0.681888,0.879541,0.763684,0.346784,0.378943,0.186041,0.337356,0.057808,0.284184,0.061162,0.272655];
			var base_ts = 1283731200000;
			var week = 0;
			var totals = {days:[], week:0};
			var display_mode = 0, display_modes = [{label: 'units', prefix: ''}, {label: '', prefix: 'Â£'}, {label: 'kgs CO2', prefix: ''}];
			var week_data;
			var unit_cost;
			week_data = energy_data.slice(week*7*24,(week+1)*7*24);
			totals = calculate_totals(week_data);

			
			 
			  var margin = {top: 40, right: 10, bottom: 60, left: 10};
              width = width - margin.left - margin.right;
              height = height - margin.top - margin.bottom;

              var formatPercent = d3.format(".0");
				
			  var svg = d3.select(element[0]).append("svg")
				  .attr("id", "svgid")
                  .attr("width", width + margin.left + margin.right)
                  .attr("height", height + margin.top + margin.bottom)
				  .attr('style',  'background-color:black')
                  .append("g")
                  .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

				

					
//creating the << down week element
	var t1 = document.createElement("text");
	t1.setAttribute("id", "downweek")
	t1.setAttribute("x", "600px")
	t1.style.color = "red";
	t1.innerHTML = "<<";
	t1.setAttribute("class", "week_step ");
	document.getElementById("ch").appendChild(t1);

//creating the >> upweek element
	var t2 = document.createElement("text");
	t2.setAttribute("id", "upweek");
	t2.style.position="absoloute";
	
	t2.style.color = "red";
	t2.innerHTML = ">>";
	t2.setAttribute("class", "week_step ");
	document.getElementById("ch").appendChild(t2);
					
					
//appending g into svg
var g = d3.select("svg").append("g").attr("id", "chart");

	var t3 = document.createElement("text");
	t3.setAttribute("id", "h")
	t3.style.color = "red";
	t3.innerHTML = "hhhhh";
	t3.setAttribute("x", "300")
	t3.setAttribute("y", "237")
	t3.setAttribute("class", "week_step ");
	d3.select("svg").append("t3");


var initial_rad = 80;
var rad_offset = 25;
var ir = function(d, i) {return initial_rad+Math.floor(i/24)*rad_offset;}
var or = function(d, i) {return initial_rad+rad_offset+Math.floor(i/24)*rad_offset;}
var sa = function(d, i) {return (i*2*Math.PI)/24;}
var ea = function(d, i) {return ((i+1)*2*Math.PI)/24;}

//Draw the chart
var color = d3.scale.linear().domain([0.04, 1]).range(["white", "red"]);
d3.select('#chart').selectAll('path').data(week_data)
	.enter().append('svg:path')
	.attr('d', d3.svg.arc().innerRadius(ir).outerRadius(or).startAngle(sa).endAngle(ea))
	.attr('transform', 'translate(300, 300)')
  	.attr('fill', color)
	.attr("stroke", "gray")
	.attr("stroke-width", "0.3px");
	

	
//Labels
var day_labels = ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'];
var label_rad = 90;
for(var i=0; i<7; i++) {
	label = day_labels[i];
	label_angle = 4.73;
	d3.select("svg").append("def")
	  .append("path")
	  .attr("id", "day_path"+i)
	  .attr('fill', "black")
	  .attr("d", "M300 300 m"+label_rad*Math.cos(label_angle)+" "+label_rad*Math.sin(label_angle)+" A"+label_rad+" "+label_rad+" 90 0 1 "+(300+label_rad)+" 300");
	d3.select("svg").append("text")
	  .attr("class", "day label")
	  .append("textPath")
	  .attr("xlink:href", "#day_path"+i)
	  .text(label);
	label_rad += rad_offset;
}

label_rad = 260;
d3.select("svg").append("def")
	.append("path")
	.attr("id", "time_path")
	.attr("d", "M300 "+(300-label_rad)+" a"+label_rad+" "+label_rad+" 0 1 1 -1 0");
for(var i=0; i<24; i++) {
	label_angle = (i-6)*(2*Math.PI/24);
	large_arc = i<6 || i> 18? 0 : 1;
	d3.select("svg").append("text")
		.attr("class", "time label")
		.append("textPath")
		.attr("xlink:href", "#time_path")
		.attr("startOffset", i*100/24+"%")
		.text(convert_to_ampm(i));
}

reset_hour_info();

//Define events
d3.selectAll("#status").on('click', function() {
	display_mode = (display_mode+1)%3;
	reset_hour_info();
});

d3.select('#upweek').on('click', function() {
	if(week>=25) return;
	week++;
	week_data = energy_data.slice(week*7*24,(week+1)*7*24);
	d3.select('#chart').selectAll('path').data(week_data).attr('fill', color);
	totals = calculate_totals(week_data);
	reset_hour_info();
})

d3.select('#downweek').on('click', function() {
	if(week<=0) return;
	week--;
	week_data = energy_data.slice(week*7*24,(week+1)*7*24);
	d3.select('#chart').selectAll('path').data(week_data).attr('fill', color);
	totals = calculate_totals(week_data);
	reset_hour_info();
})



function render_hour_info(d, i) {
	var days = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'];
	var day = Math.floor(i/24); //day index
	var h = i%24; //hour index
	var kwh = new Number(d);
	var day_kwh = new Number(totals.days[day]);
	var dm = display_modes[display_mode];
	alert("hh");
	//Update times
	d3.select('#status g.first text.time').text(days[day]);
	d3.select('#status g.second text.time').text(convert_to_ampm(h)+' - '+convert_to_ampm(parseInt(h)+1));
	d3.select('#status g.third text.time').text('Projection');

	//Update value
	switch(display_mode) {
	  case 0:
	    d3.select('#status g.first text.value').text(dm.prefix+day_kwh.toFixed(1));
	    d3.select('#status g.second text.value').text(dm.prefix+kwh.toFixed(1));
	    d3.select('#status g.third text.value').text(dm.prefix+(day_kwh*365).toFixed(0));
	    break;
	  case 1:
	    d3.select('#status g.first text.value').text(dm.prefix+(unit_cost*day_kwh).toFixed(2));
	    d3.select('#status g.second text.value').text(dm.prefix+(unit_cost*kwh).toFixed(2));
	    d3.select('#status g.third text.value').text(dm.prefix+(unit_cost*day_kwh*365).toFixed(0));
	    break;
	  case 2:
	    d3.select('#status g.first text.value').text(dm.prefix+(unit_co2*day_kwh).toFixed(1));
	    d3.select('#status g.second text.value').text(dm.prefix+(unit_co2*kwh).toFixed(1));
	    d3.select('#status g.third text.value').text(dm.prefix+(unit_co2*day_kwh*365).toFixed(0));
	    break;
	}

	//Update units
	d3.select('#status g.first text.units').text(dm.label);
	d3.select('#status g.second text.units').text(dm.label);
	d3.select('#status g.third text.units').text(dm.label+'/yr');
  }

function reset_hour_info() {
	var dm = display_modes[display_mode];
	week_kwh = new Number(totals.week);

	d3.select('#status g.first text.time').text(ts_to_datestring(base_ts, 7*week) + ' - ' + ts_to_datestring(base_ts, 7*week+6));
	d3.select('#status g.second text.time').text('');
	d3.select('#status g.third text.time').text('Projection');
	
	switch(display_mode) {
	  case 0:
	    d3.select('#status g.first text.value').text(dm.prefix+week_kwh.toFixed(1));
	    d3.select('#status g.second text.value').text('');
	    d3.select('#status g.third text.value').text(dm.prefix+(week_kwh*365/7).toFixed(0));
	    break;
	  case 1:
	    d3.select('#status g.first text.value').text(dm.prefix+(unit_cost*week_kwh).toFixed(2));
	    d3.select('#status g.second text.value').text('');
	    d3.select('#status g.third text.value').text(dm.prefix+(unit_cost*week_kwh*365/7).toFixed(0));
	    break;
	  case 2:
	    d3.select('#status g.first text.value').text(dm.prefix+(unit_co2*week_kwh).toFixed(1));
	    d3.select('#status g.second text.value').text('');
	    d3.select('#status g.third text.value').text(dm.prefix+(unit_co2*week_kwh*365/7).toFixed(0));
	    break;
	}

	d3.select('#status g.first text.units').text(dm.label);
	d3.select('#status g.second text.units').text('');
	d3.select('#status g.third text.units').text(dm.label+'/yr');
}

function ts_to_datestring(ts, day_offset) {
	var date = new Date(ts + day_offset * 3600 * 24 * 1000);
	return date.toDateString().slice(4, 10);
}

function calculate_totals(week_data) {
	var totals = {days:[0, 0, 0, 0, 0, 0, 0], week:0};
		for(var d=0; d<7; d++) {
			for(var h=0; h<24; h++)
				totals.days[d]+=week_data[d*24+h];
			totals.week += totals.days[d]
		}
	return totals;
}

function convert_to_ampm(h) {
	if(h=='0' || h=='24')
	  return 'Midnight';
	var suffix = 'am';
	if(h>11) suffix = 'pm';
	if(h>12)
	  return (h-12)+suffix;
	else
	  return h+suffix;
}
	
	

	
				var tip = d3tip()
				.attr("class", "d3-tip")
				.html(function(d, i){
				var days = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'];
				var day = Math.floor(i/24); //day index
				var h = i%24; //hour index
				var kwh = new Number(d);
				var day_kwh = new Number(totals.days[day]);
				var dm = display_modes[display_mode];
				return "<strong>Units:</strong> <span style='color:red'>"+dm.prefix+day_kwh.toFixed(1)+"</span>\n<strong>Projection:</strong> <span style='color:red'>"+dm.prefix+(day_kwh*365)+ "</span>";
				})
				
				
              svg.call(tip);
			


	d3.select('#chart').selectAll('path').data(week_data)
	.on('mouseover', tip.show)
	.on('mouseout', tip.hide);



          }
        }
      };
    });
  });
